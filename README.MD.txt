Из «Бета-Банка» стали уходить клиенты. Каждый месяц. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых.

Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Вам предоставлены исторические данные о поведении клиентов и расторжении договоров с банком.

Постройте модель с предельно большим значением F1-меры. Чтобы сдать проект успешно, нужно довести метрику до 0.59. Проверьте F1-меру на тестовой выборке самостоятельно.

Дополнительно измеряйте AUC-ROC, сравнивайте её значение с F1-мерой.


Цель исследования заключется в построении наилучшей с точки зрения меры F1 модели класификации "поведения" клиентов Банка, что позволит прогнозировать вероятность ухода клента Банка.
    
План работы:

1.1 Получение и подготовка данных:
- загрузить данные
- получить первое представление о данных: типы переменных, отсутствующие значения, повторы, аномалии
- предобработка данных: восстановление пропусков, изменение типов переменных, обработка скрытых дубликатов и повторов, обработка ошибок в данных
2. Исследование задачи
- подготовка данных для использования в моделях: выделение категориальных переменных в отдельные dummy переменные, нормализация числовых переменных,
- разбиение данных на тренировочный, валидационный и тестовые наборы
- построение моделей: дерева решений, случайного леса и логистической регрессии - на основе несбалансированных данных
- обучение моделей на тренировочных данных и определение наилучших моделей на основе валидационных данных
3. Балансировка даных и построение на их основе тренировочных данных указанных выше моделей классификации. Определение наилучших моделей на основе валидационных даных. 
4. Проверка наилучших моделей на тестовой выборке
5. Вывод об итогах исследования

Создадим функцию для построения дерева решений на основе тренировочных данных и выявлении наилучшей модели на валидационной выборке на основе критерия F1, перебирая глубину дерева и порога классификации, и AUC-ROC, перебирая глубину дерева

Создадим функцию для построения случайного леса на основе тренировочных данных и выявлении наилучшей модели на валидационной выборке на основе критерия F1, перебирая глубину и количесвто деревьев, а также порог классификации, и AUC-ROC, перебирая глубину дерева и их количество

Создадим функцию для построения логистической регрессии на основе тренировочных данных и выявлении наилучшей модели на валидационной выборке на основе критерия F1, перебирая порог классификации, и AUC-ROC

Вывод для несбалансированных данных:
- все модели на валидационных данных показали себя лучше по сравнению со случайным классификатором - матрика AUC-ROC моделей больше 0.5 
- наилучший результат на основе метрики F1 показала модель случайного леса: F1=0.64. Указанная модель также имеет наибольшее значение критерия AUC-ROC=0.86

В целях повышения качества обучения моделей и соответсвтенно снижения ошибочной классификации клиентов Банка проведем балансировку выборки.

Вывод для сбалансированных данных:
Как и на несбалансированных данных модель случайного леса на всех сбалансированных данных показала наилучшие результаты F1=0.65-0.66, AUC-ROC=0.87-0.88.   
Все модели на валидационных данных показали себя лучше по сравнению со случайным классификатором - метрика AUC-ROC моделей больше 0.5 

Результаты наилучшей модели на тренировочной выборке:
Результаты моделей, полученные на тестовой выборке, достаточно близски с результатми, полученными на валидационной выборке, что свидетельствует об отсутствии факта переобучения моделей. Модели также лучше себя показали по сравнению со случайным классификатором AUC-ROC>0.5
Тем не менее заданный порог в F1>=0.59 преодолела только модель случайного леса, AUC-ROC=0.87.
Следует отметить, что обучение модели наиболее трудозатраное и требует значительно большего количества времени на подбор наилучших параметров модели.
Таким образом, можно рекомендовать использовать обученную модель случайного леса для оценки вероятности ухода клиента.